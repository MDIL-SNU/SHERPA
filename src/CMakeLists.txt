CMAKE_MINIMUM_REQUIRED ( VERSION 3.13 )
PROJECT ( Saddle_point_search )
ENABLE_LANGUAGE ( C )

SET ( LAMMPS_SRC_DIRECTORY "" CACHE PATH "Path for lammps source" )
IF ( NOT LAMMPS_SRC_DIRECTORY STREQUAL "" AND EXISTS ${LAMMPS_SRC_DIRECTORY}/cmake/CMakeLists.txt )
  OPTION( BUILD_LIB "Build LAMMPS library" ON )
  ADD_SUBDIRECTORY ( ${LAMMPS_SRC_DIRECTORY}/cmake lammps )
ELSE()
  FIND_PACKAGE( LAMMPS REQUIRED )
ENDIF()

FIND_PACKAGE ( MKL CONFIG REQUIRED )

SET ( CMAKE_VERBOSE_MAKEFILE true )
SET ( SRC_FILES 
        main.c 
        calculator.c
        config.c
        dataset.c
        dimer.c
        kappa_dimer.c
        snc_dimer.c
        input.c
        target.c
        utils.c )
SET ( CMAKE_C_COMPILER "mpiicc" )
ADD_COMPILE_OPTIONS ( -O3 -g -Wall )
LINK_LIBRARIES ( m )
ADD_EXECUTABLE ( SPS ${SRC_FILES} )

TARGET_COMPILE_OPTIONS ( SPS PUBLIC $<TARGET_PROPERTY:MKL::MKL,INTERFACE_COMPILE_OPTIONS> )
TARGET_INCLUDE_DIRECTORIES ( SPS PUBLIC $<TARGET_PROPERTY:MKL::MKL,INTERFACE_INCLUDE_DIRECTORIES> )

#TARGET_LINK_LIBRARIES ( SPS LAMMPS::lammps )

TARGET_LINK_LIBRARIES ( SPS PUBLIC $<LINK_ONLY:MKL::MKL> LAMMPS::lammps )
